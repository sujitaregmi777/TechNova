{% extends "base.html" %}
{% block title %}Shared Reflections · MoodMate{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto space-y-14 py-10">

  <!-- HEADER -->
  <header class="flex justify-between items-start">
    <div class="space-y-1">
      <h1 class="text-3xl font-bold">Shared Reflections</h1>
      <p class="text-sm text-[var(--muted)]">
        A quiet place where thoughts are heard, not judged.
      </p>
    </div>

    <a href="{% url 'explore' %}"
       class="text-sm font-medium text-[var(--primary)] hover:underline">
      Read Gentle Articles →
    </a>
  </header>

  <!-- CTA -->
  <div class="text-center py-6">
    <a href="{% url 'create_reflection' %}"
       class="inline-block px-6 py-3 rounded-full
              bg-[var(--primary)] text-white font-semibold">
      Share your thought
    </a>
  </div>

  <!-- FEED -->
  <section class="space-y-12">
    {% for r in reflections %}
    <article
      class="p-7 sm:p-9 rounded-3xl bg-[var(--surface)]
             border border-[var(--border)] space-y-6">

      <!-- MOOD -->
      <span class="text-xs tracking-widest uppercase text-[var(--primary)]">
        {{ r.get_mood_display }}
      </span>

      <!-- CONTENT -->
      <p class="text-lg leading-relaxed">
        {{ r.text }}
      </p>

      <!-- META -->
      <div class="flex justify-between text-sm text-[var(--muted)]">
        <span>— {{ r.display_name }}</span>
        <span>{{ r.created_at|timesince }} ago</span>
      </div>

      <!-- COMMENTS -->
      {% if r.comments.exists %}
      <div class="pt-4 border-t border-[var(--border)] space-y-3">
        {% for c in r.comments.all %}
        <p class="text-sm">
          <span class="font-medium">{{ c.author.username }}:</span>
          {{ c.content }}
        </p>
        {% endfor %}
      </div>
      {% endif %}

      <!-- COMMENT FORM -->
      {% if user.is_authenticated %}
      <form method="post" action="{% url 'add_comment' r.id %}" class="pt-3">
        {% csrf_token %}
        <textarea name="content" rows="2"
          class="w-full bg-transparent border-b border-[var(--border)]
                 focus:outline-none focus:border-[var(--primary)]
                 text-sm"
          placeholder="Respond gently…"></textarea>
      </form>
      {% endif %}
    </article>
    {% endfor %}
  </section>

</div>
{% endblock %}
