{% load static %}
<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}MoodMate{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>

  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">

  <style>
    :root {
      --bg: #f6f5f8;
      --surface: #ffffff;
      --surface-alt: #f0eef6;
      --border: #e4e1ec;
      --text: #1e1b2e;
      --muted: #6f6a85;
      --primary: #7c5cff;
    }

    html.dark {
      --bg: #150f23;
      --surface: #201736;
      --surface-alt: #2d204b;
      --border: #33265a;
      --text: #ffffff;
      --muted: #a08dce;
      --primary: #a680ff;
    }
  </style>
</head>

<body class="bg-[var(--bg)] text-[var(--text)] min-h-screen flex transition-colors duration-200">

<!-- SIDEBAR -->
<aside
  class="group w-20 hover:w-72 transition-all duration-300
         bg-[var(--surface)] border-r border-[var(--border)]
         flex flex-col p-4 gap-8">

  <div class="flex items-center gap-3">
    <span class="material-symbols-outlined text-[var(--primary)] text-3xl">spa</span>
    <span class="hidden group-hover:block font-bold text-lg">MoodMate</span>
  </div>

  <nav class="flex flex-col gap-2 text-sm">

    <a href="/dashboard/"
       class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
      <span class="material-symbols-outlined text-[var(--primary)]">home</span>
      <span class="hidden group-hover:block font-medium">Dashboard</span>
    </a>

    <a href="/journals/"
       class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
      <span class="material-symbols-outlined text-[var(--primary)]">menu_book</span>
      <span class="hidden group-hover:block font-medium">Journal</span>
    </a>

    <a href="/ai-chat/"
       class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
      <span class="material-symbols-outlined text-[var(--primary)]">smart_toy</span>
      <span class="hidden group-hover:block font-medium">AI Chat</span>
    </a>

    <a href="/podcasts/"
       class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
      <span class="material-symbols-outlined text-[var(--primary)]">podcasts</span>
      <span class="hidden group-hover:block font-medium">Podcast</span>
    </a>

    <a href="/breathing/"
       class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
      <span class="material-symbols-outlined text-[var(--primary)]">air</span>
      <span class="hidden group-hover:block font-medium">Breathing</span>
    </a>

    <a href="/blogs/"
   class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
  <span class="material-symbols-outlined text-[var(--primary)]">forum</span>
  <span class="hidden group-hover:block font-medium">Community</span>
</a>


  </nav>

  <div class="flex-1"></div>

  <div class="flex flex-col gap-2 border-t border-[var(--border)] pt-4 text-sm">

    <a href="/settings/"
       class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
      <span class="material-symbols-outlined text-[var(--primary)]">settings</span>
      <span class="hidden group-hover:block font-medium">Settings</span>
    </a>

    {% if user.is_authenticated %}
      <a href="/logout/"
         class="flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-[var(--surface-alt)]">
        <span class="material-symbols-outlined text-[var(--primary)]">logout</span>
        <span class="hidden group-hover:block font-medium">Log out</span>
      </a>
    {% endif %}

  </div>

</aside>


<div class="flex-1 flex flex-col">

  <header
    class="h-16 px-6 flex items-center justify-end gap-4
           border-b border-[var(--border)]
           bg-[var(--surface)]">

    <!-- Theme Toggle -->
    <button onclick="toggleTheme()"
      class="w-10 h-10 flex items-center justify-center rounded-full
             hover:bg-[var(--surface-alt)] transition">
      <span id="themeIcon" class="material-symbols-outlined">dark_mode</span>
    </button>

 <div class="relative">
  <!-- Avatar Button -->
  <button
    id="profileBtn"
    onclick="toggleProfileMenu()"
    class="w-10 h-10 rounded-full bg-[var(--primary)]/20
           flex items-center justify-center hover:bg-[var(--primary)]/30
           transition focus:outline-none">

    <!-- later this can be an <img> -->
    <span class="material-symbols-outlined text-[var(--primary)]">person</span>
  </button>

  <!-- Dropdown -->
  <div
    id="profileMenu"
    class="hidden absolute right-0 mt-2 w-48
           rounded-xl border border-[var(--border)]
           bg-[var(--surface)] shadow-lg overflow-hidden z-50">

    {% if user.is_authenticated %}
      <a href="/settings/"
         class="flex items-center gap-3 px-4 py-3 text-sm
                hover:bg-[var(--surface-alt)] transition">
        <span class="material-symbols-outlined text-[var(--muted)] text-base">
          manage_accounts
        </span>
        <span>Profile settings</span>
      </a>

      <a href="/logout/"
         class="flex items-center gap-3 px-4 py-3 text-sm
                hover:bg-[var(--surface-alt)] transition">
        <span class="material-symbols-outlined text-[var(--muted)] text-base">
          logout
        </span>
        <span>Log out</span>
      </a>
    {% else %}
      <a href="/login/"
         class="flex items-center gap-3 px-4 py-3 text-sm
                hover:bg-[var(--surface-alt)] transition">
        <span class="material-symbols-outlined text-[var(--muted)] text-base">
          login
        </span>
        <span>Sign in</span>
      </a>
    {% endif %}

  </div>
</div>

  </header>

  <!-- CONTENT -->
  <main class="flex-1 p-6 sm:p-8">
    {% block content %}{% endblock %}
  </main>

</div>

<script>
  function toggleTheme() {
    const html = document.documentElement;
    const icon = document.getElementById("themeIcon");

    html.classList.toggle("dark");
    const isDark = html.classList.contains("dark");

    icon.textContent = isDark ? "dark_mode" : "light_mode";
    localStorage.setItem("theme", isDark ? "dark" : "light");
  }

  (function () {
    const saved = localStorage.getItem("theme");
    if (saved === "light") {
      document.documentElement.classList.remove("dark");
      document.getElementById("themeIcon").textContent = "light_mode";
    }
  })();


  function toggleProfileMenu() {
    document.getElementById("profileMenu").classList.toggle("hidden");
  }

  document.addEventListener("click", function (e) {
    const btn = document.getElementById("profileBtn");
    const menu = document.getElementById("profileMenu");

    if (!btn.contains(e.target) && !menu.contains(e.target)) {
      menu.classList.add("hidden");
    }
  });



</script>

</body>
</html>
